FROM --platform=linux/amd64 golang:1.23-bullseye

# Install required packages
RUN apt-get update && apt-get install -y \
    build-essential \
    git \
    curl \
    wget \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Set build tags for Linux
ENV GOOS=linux
ENV GOARCH=amd64
ENV CGO_ENABLED=1
ENV GO111MODULE=on
ENV CC=gcc

# Copy go mod files
COPY go.mod go.sum ./

# Download dependencies
RUN go mod download

# Copy source code
COPY . .

# Build the application
RUN go build -tags linux -o auroraboot

# Set the entrypoint
ENTRYPOINT ["/app/auroraboot"] 